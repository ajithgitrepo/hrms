{% extends "layouts/base.html" %}

{% load custom_tags %}

{% block title %} Remaining Leaves {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet"></link>


<link rel="stylesheet" href="/static/assets/vendor/animate.css/animate.min.css">
<link rel="stylesheet" href="/static/assets/vendor/sweetalert2/dist/sweetalert2.min.css">
<!-- <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.3/css/bootstrap-select.min.css" /> -->
<style>
.select2-container--default .select2-selection--single .select2-selection__rendered {
    line-height: inherit;
    color: inherit;
    float: left;
}

/* Chrome, Safari, Edge, Opera */
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
input[type=number] {
  -moz-appearance: textfield;
}

.half {
   float: left;
   width: 49%;
   margin: 2px;
}

input[type="radio"]:checked+label { font-weight: bold; }

input[type="radio"] {
  margin-right: 10px;
}

.checkboxes label {
  display: inline-block;
  padding-right: 10px;
  white-space: nowrap;
}
.checkboxes input {
  vertical-align: middle;
}
.checkboxes label span {
  vertical-align: middle;
}
.modal-lg {
    max-width: 60% !important;
}

select#ddl_employee_id {
    font-size: 14px;
   
    font-weight: 800;
    border-width: -11px;
    border: 3px solid;
    
    color: cornflowerblue;
}
.modal-body {
    padding-left: 57px !important;
}
.modal {
display: none;
position: fixed;
z-index: 1;
/* padding-top: 100px; */
left: 0;
top: 0;
width: 100%;
height: 100%;
overflow: auto;
background-color: rgb(0,0,0);
background-color: rgba(0,0,0,0.7); /* <-- this is the culprit */
}
</style>
{% endblock stylesheets %}
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="/static/assets/vendor/animate.css/animate.min.css">
  <link rel="stylesheet" href="/static/assets/vendor/sweetalert2/dist/sweetalert2.min.css">
{% block content %}

 {% role_name as role %}
 
  <!-- Header -->
  <div class="header bg-primary pb-6">
    <div class="container-fluid">
      <div class="header-body">
        <div class="row align-items-center py-4">
          <div class="col-lg-6 col-7">
            <h6 class="h2 text-white d-inline-block mb-0">Leave Tracker</h6>
            <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
              <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
                <li class="breadcrumb-item"><a href="#"><i class="fas fa-user"></i></a></li>
                <li class="breadcrumb-item"><a href="#">Settings > Remaining Leaves</a></li>
                <!-- <li class="breadcrumb-item active" aria-current="page">Datatables</li> -->
              </ol>
            </nav>
          </div>
          <div class="col-lg-6 col-5 text-right">
           
            <!-- <a href="{% url 'add_roles' %}" class="btn btn-sm btn-neutral">Add</a> 
            <a href="#" class="btn btn-sm btn-neutral">Filters</a> -->
          </div> 
        </div>
      </div>
    </div>
  </div>

  <!-- Page content -->
  <div class="container-fluid mt--6">
    
    <!-- Table -->
    <div class="row">
      <div class="col">
      
        <div class="card">
          <!-- Card header -->
          <div class="card-header">
            <!-- <h3 class="mb-0">Customize Policy</h3> -->
             <div class="row justify-content-center">
            <div class="col-lg-4">
                <select id="ddl_employee_id"  class="form-control select2" data-toggle="select"  data-live-search="true" value="{{ form.data.role }}" name="role">
                  {% if role == "Admin" %}
                    {% for Employee in Employees %}
                    <option data-foo="{{ Employee.date_of_joining |date:'d-m-Y' }}" value="{{ Employee.employee_id }}" {% if form.data.Employee == "{{ Employee.employee_id }}" %} selected{% endif %}> {{ Employee.first_name }}{{ Employee.last_name }} ({{ Employee.employee_id }}) </option>
                    {% endfor %} 
                  {% endif %}

                  {% if role == "Manager" %}
                    <option value="{{ request.user.emp_id }}" {% if request.user.emp_id == emp_id %} selected{% endif %} {% if request.user.emp_id == user.emp_id %} selected{% endif %} > {{ request.user.first_name }} {{ request.user.last_name }}</option>
                    {% for emp in Employees %}
                        <option data-foo="{{ emp.employee.date_of_joining |date:'d-m-Y' }}" value="{{ emp.employee.employee_id }}" {% if emp.employee.employee_id == emp_id %} selected{% endif %} {% if emp.employee.employee_id == user.emp_id %} selected{% endif %} > {{ emp.employee.first_name }} {{ emp.employee.last_name }} </option>
                    {% endfor %} 
                  {% endif %}


                </select>
              </div>
           </div>
           
          </div>
          <div class="table-responsive py-4">
            <table class="table table-flush" id="datatable">
              <thead class="thead-light">
                <tr>
                  <th>#</th>
                  <th>Leave Type</th>
                  <th>Type</th>
                  <th>Unit</th>
                  <th>Balance</th>
                  <!-- <th>Action</th> -->
                </tr>
              </thead>
              <!-- <tfoot>
                <tr>
                  <th>Name</th>
                  <th>Position</th>
                  <th>Office</th>
                  <th>Age</th>
                  <th>Start date</th>
                  <th>Salary</th>
                </tr>
              </tfoot> -->
              <tbody id="tbodyid">
                {% for data in Leave_Types %}
                <tr>
                  {{tot0}}
                    <td>{{ forloop.counter }}</td>
                    <td style='font-weight: bolder;' class="nr"  data-leave_id="{{ data.leave_type.id }}">
                          <a  data-toggle="tooltip" data-original-title="Change Policy"  class="use-address">{{data.leave_type.name}}</a>
                          <span style="color: crimson;">  {% if data.type != None %} ({{data.type}}) {% endif %}
                             </span>
                        </td>
                    <td>{{data.leave_type.type}}   </span></td>
                    <td>{{data.leave_type.unit}}</td>
                    <td>{{data.balance}}</td>
                    <!-- <td>
                         <a class="use-address fas fa-add" style="color: blue;"   data-toggle="tooltip" data-original-title="Change Policy" >Customize</a> 
                     </td> -->
                    
                </tr>
                {% endfor %}
                <tr><td></td><td></td><td></td><td style="float: right;font-weight: bolder;">Total Days:</td><td id="last_td" style="color:red;font-weight: bolder;">{{tot}}</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    
  </div>


  <div class="card-body">
      <div class="row">
        <div class="col-md-12">
          <!-- <button type="button" class="btn btn-block btn-primary mb-3" data-toggle="modal" data-target="#modal-default">Default</button> -->
          <div id="myModal" class="modal fade" id="modal-default" tabindex="-1" role="dialog" aria-labelledby="modal-default" aria-hidden="true">
            <div class="modal-dialog modal-lg modal- modal-dialog-centered modal-" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h6 class="modal-title" id="modal-title-default">Customize Leave Details</h6>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                  </button>
                </div>
                <div class="modal-body">
                      <input type="hidden" id="Hid_LeaveID"></input>
                  <table class="">
                        <tr>
                              <td>&nbsp;</td>
                              <!-- <td ><label class="form-control-label" for="input-email">Effective After</label></td>
                              <td>&nbsp;</td> -->
                              <!-- <td><input style="width:50px;float: right;" id="txt_effect_number" type="number" name="effect_number" value="0" class="form-control half" placeholder="" >
                              </td>
                              <td><select id="" class="form-control half"><option value="0">Year(s)</option>
                                    <option value="1">Month(s)</option>
                                    <option value="2">Day(s)</option></select>
                              </td> -->
                              <td><label class="form-control-label" for="input-email">Effective From
                              </label></td>
                              <!-- <td> <select class="form-control">
                                    <option value="date_of_joining">Date of Joining</option>
                                    <option value="date_of_confirmation">Date of Confirmation</option>
                                   </select> -->
                                   <td> <input id="txt_date_of_birth" class="form-control startdate" placeholder="dd-mm-yyyy"></input>
                                    <input type="hidden" id="Hid_dob"></input>
                                    <input type="hidden" id="Hid_type"></input>
                              </td>
                        </tr>

                        <tr>
                              <td>
                                    <!-- <div class="custom-control custom-checkbox mb-3"> -->
                                          <input class="custom-control-input accurcheck" checked style="float: right;" id="customCheck1" type="checkbox" onchange="valueChanged_accur(event);">
                                          <label class="custom-control-label" style="float: right;margin-top: -12px;" for="customCheck1"></label> 
                                        <!-- </div> -->
                              </td>
                              <td ><label class="form-control-label" for="input-email">Accural</label></td>
                              <!-- <td>&nbsp;</td> -->
                              <!-- <td><input style="width:50px;" type="number" name="effect_number" value="{{ form.data.name }}" class="form-control" placeholder="Name" ></td> -->
                              <td class="accur"><select id="ddl_accural_1st" class="form-control">
                                    <option unit="0" value="01">Yearly</option>
                                    <!-- <option unit="0" value="00">One Time</option> -->
                                   
                                    <option unit="1" value="11">Monthly</option>
                                    <!--  <option unit="1" value="16">Half Yearly</option>
                                   <option unit="1" value="14">Triannually</option>
                                    <option unit="1" value="13">Quarterly</option>
                                    <option unit="1" value="12">Bi Monthly</option>
                                    <option unit="3" value="315">Semi Monthly</option>
                                    <option unit="2" value="22">Bi Weekly</option> -->
                                    <option unit="2" value="21">Weekly</option> 
                                  </select>
                              </td>
                              <td class="accur"><label class="form-control-label" for="input-email">on</label></td>
                              <td class="accur" id="accur_ddl_2nd_td"> <select class="form-control" id="ddl_accural_2nd">
                                    <option value="1">1st</option>
                                    <option value="2">2nd</option><option value="3">3rd</option>
                                    <option value="4">4th</option><option value="5">5th</option>
                                    <option value="6">6th</option><option value="7">7th</option>
                                    <option value="8">8th</option><option value="9">9th</option>
                                    <option value="10">10th</option><option value="11">11th</option>
                                    <option value="12">12th</option><option value="13">13th</option>
                                    <option value="14">14th</option><option value="15">15th</option>
                                    <option value="16">16th</option><option value="17">17th</option>
                                    <option value="18">18th</option><option value="19">19th</option>
                                    <option value="20">20th</option><option value="21">21st</option>
                                    <option value="22">22nd</option><option value="23">23rd</option>
                                    <option value="24">24th</option><option value="25">25th</option>
                                    <option value="26">26th</option><option value="27">27th</option>
                                    <option value="28">28th</option><option value="29">29th</option>
                                    <option value="30">30th</option><option value="31">31st</option>
                                    <!-- <option value="32">Last Day</option><option value="-1">Policy Date</option>
                                    <option value="-2">Joining Date</option><option value="-3">Birth Date</option> -->
                                   </select>
                              </td>
                              <td class="accur" id="accural_3rd_td"> <select class="form-control" id="ddl_accural_3rd">
                                    <option value="1">Jan</option>
                                    <option value="2">Feb</option>
                                    <option value="3">Mar</option>
                                     <option value="4">Apr</option><option value="5">May</option>
                                    <option value="6">Jun</option><option value="7">Jul</option>
                                    <option value="8">Aug</option><option value="9">Sep</option>
                                    <option value="10">Oct</option><option value="11">Nov</option>
                                    <option value="12">Dec</option>
                                    <!-- <option value="-1">Policy Month</option>
                                    <option value="-2">Joining Month</option><option value="-3">Birth Month</option> -->
                                   </select>
                              </td>
                              <td class="accur" id="num_of_days"><label class="form-control-label" for="input-email">No. of Days</label></td>
                              <td class="accur"><input style="width:50px;" type="number" name="effect_number" id="effect_number" value="0" class="form-control" placeholder="" ></td>
                              <!-- <td class="accur" id="accur_in"><label class="form-control-label" for="input-email">in</label</td> -->
                              <!-- <td class="accur" id="accur_ddl_4th"> <select class="form-control" id="ddl_accural_4th">
                                   <option value="Current Accural">Current Accural</option>
                                    <option value="Next Accural">Next Accural</option>
                                    </select>
                              </td> -->
                        </tr>


                        <tr>
                              <td>
                                    <input class="custom-control-input resetcheck" checked style="float: right;" id="customCheck11" type="checkbox" onchange="valueChanged_reset(event);">
                                    <label class="custom-control-label" style="float: right;margin-top: -12px;" for="customCheck11"></label>
                              </td>
                              <td><label class="form-control-label" for="input-email">Reset</label></td>
                              <!-- <td>&nbsp;</td> -->
                              <!-- <td><input style="width:50px;" type="number" name="effect_number" value="{{ form.data.name }}" class="form-control" placeholder="Name" ></td> -->
                              <td class="reset"><select id="reset_ddl_1st"  class="form-control">
                                    <option unit="0" value="01">Yearly</option>
                                    <!-- <option unit="0" value="00">One Time</option> -->
                                    <option unit="1" value="11">Monthly</option>
                                    <!-- <option unit="1" value="16">Half Yearly</option>
                                    <option unit="1" value="14">Triannually</option>
                                    <option unit="1" value="13">Quarterly</option>
                                    <option unit="1" value="12">Bi Monthly</option> -->
                                    <!-- <option unit="3" value="315">Semi Monthly</option>
                                    <option unit="2" value="22">Bi Weekly</option> -->
                                    <option unit="2" value="21">Weekly</option>
                                  </select>
                              </td>
                              <td class="reset" ><label class="form-control-label" for="input-email">on</label></td>
                              <td class="reset" id="reset_ddl_1st_td"> 
                                    <select class="form-control"  id="reset_ddl_2nd" >
                                    <option  value="32">Last Day</option>
                                     <option value="1">1st</option><option value="2">2nd</option>
                                    <option value="3">3rd</option><option value="4">4th</option>
                                    <option value="5">5th</option><option value="6">6th</option>
                                    <option value="7">7th</option><option value="8">8th</option><option value="9">9th</option>
                                    <option value="10">10th</option><option value="11">11th</option><option value="12">12th</option>
                                    <option value="13">13th</option><option value="14">14th</option><option value="15">15th</option>
                                    <option value="16">16th</option><option value="17">17th</option><option value="18">18th</option>
                                    <option value="19">19th</option><option value="20">20th</option><option value="21">21st</option>
                                    <option value="22">22nd</option><option value="23">23rd</option><option value="24">24th</option>
                                    <option value="25">25th</option><option value="26">26th</option><option value="27">27th</option>
                                    <option value="28">28th</option><option value="29">29th</option><option value="30">30th</option>
                                    <option value="31">31st</option>
                                    <!-- <option value="-1">Policy Date</option>
                                    <option value="-2">Joining Date</option><option value="-3">Birth Date</option> -->

                                   </select>
                              </td>
                              <td class="reset" id="reset_ddl_2nd_td"> 
                                    <select class="form-control" id="reset_ddl_3rd">
                                     <option  value="12">Dec</option>
                                    <option value="1">Jan</option>
                                    <option value="2">Feb</option>
                                    <option value="3">Mar</option>
                                     <option value="4">Apr</option><option value="5">May</option>
                                    <option value="6">Jun</option><option value="7">Jul</option>
                                    <option value="8">Aug</option><option value="9">Sep</option>
                                    <option value="10">Oct</option><option value="11">Nov</option>
                                    <!-- <option value="-1">Policy Month</option>
                                    <option value="-2">Joining Month</option><option value="-3">Birth Month</option> -->
                                   </select>
                              </td>
                             
                        </tr>

                        <tr class="reset">
                              <td><label class="form-control-label" for="input-email"></label></td>
                              <td>&nbsp;</td>
                              <!-- <td><input style="width:50px;" type="number" name="effect_number" value="{{ form.data.name }}" class="form-control" placeholder="Name" ></td> -->
                              <td><select class="form-control" id="reset_ddl_carry_1st">
                                    <option value="0">Carry Forward</option>
                                     <!-- <option value="1">Carry Forward With Expiry</option> 
                                   <option value="2">Carry Forward With Overall Limit</option> -->
                                  </select>
                              </td>
                              <td ><input style="width:50px;" type="number" id="carry_effect_number" name="effect_number" value="0" class="form-control" placeholder="" ></td>
                              <!-- <td><label class="form-control-label" for="input-email">on</label></td> -->
                              <td> <select class="form-control" id="reset_ddl_carry_units_1st">
                                    <option value="0">Unit(s)</option>
                                    <option value="1" selected="selected">Percentage</option></select>
                                   </select> 
                              </td>
                              <!-- <td id="reset_ddl_carry_1st_td"><label class="form-control-label" for="input-email">Overall Limit</label></td> -->
                              <!-- <td id="reset_ddl_carry_2nd_td"><input style="width:50px;" id="carry_percentage" type="number" name="effect_number" value="0" class="form-control" placeholder="" ></td> -->
                              
                              <td id="reset_ddl_carry_3rd_td"><label class="form-control-label" for="input-email">Max Limit</label></td>
                              <td id="reset_ddl_carry_4th_td"><input style="width:50px;" id="carry_maxlimit_effect_number" type="number" name="effect_number" value="0" class="form-control" placeholder="" ></td>
                              <td id="reset_ddl_carry_5th_td" colspan="2"><span style="margin-top: 1px;"> Expires in</span> </td>
                              <td id="reset_ddl_carry_6th_td"> 
                                   <input style="width:50px;" type="number" name="effect_number" value="0" class="form-control" placeholder="" >
                              </td>
                              <td id="reset_ddl_carry_7th_td"> 
                                    <select class="selectBox select2-offscreen" name="reset_expiry_unit" tabindex="-1"><option value="1">Month(s)</option><option value="4">Day(s)</option></select>
                              </td>
                        </tr>

                        <tr class="reset">
                              <td><label class="form-control-label" for="input-email"></label></td>
                              <td>&nbsp;</td>
                              <!-- <td><input style="width:50px;" type="number" name="effect_number" value="{{ form.data.name }}" class="form-control" placeholder="Name" ></td> -->
                              <!-- <td><label class="form-control-label" for="input-email">Encashment</label>
                              </td>
                              <td><input style="width:50px;" type="number" name="effect_number" value="0" class="form-control" placeholder="" ></td> -->
                              <!-- <td><label class="form-control-label" for="input-email">on</label></td> -->
                              <!-- <td> <select id="reset_ddl_carry_last" class="form-control">
                                    <option value="0">Unit(s)</option>
                                    <option value="1" selected="selected">Percentage</option></select>
                                    </select>
                              </td>
                              <td id="reset_ddl_carry_last0_td"><label class="form-control-label" for="input-email">Max Limit</label></td>
                              <td id="reset_ddl_carry_last1_td"><input style="width:50px;" type="number" name="effect_number" value="0" class="form-control" placeholder="" ></td> -->
                             
                        </tr>
                        <tr>
                              <!-- <td>
                                    <input class="custom-control-input openbalcheck"  id="customCheck13" type="checkbox" onchange="valueChanged_openbal(event);">
                                    <label style="float: right;margin-top: -12px;" class="custom-control-label" style="float: right;margin-top: -12px;" for="customCheck13"></label>
                              </td > -->
                              <!-- <td  colspan="2"><label class="form-control-label" style="margin-right: 75px;" for="input-email">Opening Balance</label></td> -->
                              <!-- <td class="openbal" >
                                    <input style="width:50px;float: none;" type="number" name="effect_number" value="0" class="form-control half" placeholder="">  
                              </td> -->
                        </tr>
                        <tr>
                              <!-- <td>
                                    <input class="custom-control-input maxibalcheck"  id="customCheck12" type="checkbox" onchange="valueChanged_maxibal(event);">
                                    <label style="float: right;margin-top: -12px;" class="custom-control-label" style="float: right;margin-top: -12px;" for="customCheck12"></label>
                              </td> -->
                              <!-- <td  colspan="2"><label class="form-control-label" style="margin-right: 75px;" for="input-email">Maximum Balance</label></td>
                              <td class="maxibal">
                                    <input style="width:50px;float: none;" type="number" name="effect_number" value="0" class="form-control half" placeholder="">  
                              </td> -->
                        </tr>
                    <tr><td colspan="8"> <center> <button type="submit" class="btn btn-info" id="BtnSubmit" >Submit</button> </center></td></tr>
                  </table>
                 
                </div>
               
              </div>
            </div>

          </div>
        </div>
      </div>
  </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script src="/static/assets/vendor/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
<script src="/static/assets/vendor/moment.min.js"></script>
<script src="/static/assets/vendor/bootstrap-datetimepicker.js"></script>


<script src="/static/assets/vendor/sweetalert2/dist/sweetalert2.min.js"></script>
  <script src="/static/assets/vendor/bootstrap-notify/bootstrap-notify.min.js"></script>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.full.min.js"></script> -->
  <!-- Optional JS -->
  
    <script type="text/javascript">
         $(function() {
            //$('#myModal').modal('show');
                  
});

$(function () {
      var dateToday = new Date();
           // $("#date_of_joining1").datepicker({ dateFormat: "dd/mm/dd", changeMonth: true, changeYear: true });
           $(".startdate").datepicker({format: 'dd-mm-yyyy',  autoclose: true,
        todayBtn: "linked",
        todayHighlight: true,});
         
});

// $('#txt_date_of_birth').change(function() {
//     var date = $(this).val();
//     alert();
//     if(date == null)
//     $('#txt_date_of_birth').val($('#Hid_dob').val());
//     console.log(date, 'change')
// });

// $("#txt_date_of_birth").datepicker({ 
//     onSelect: function(dateText) {
//         alert("Selected date: " + dateText + "; input's current value: " + this.value);
//     }
// });

// $('#txt_date_of_birth').datepicker()
//     .on("input change", function (e) {
//     alert("Date changed: ", e.target.value);
// });
// $(document).click(function (e) {

// //Clic hors de la ligne ou du calendrier ou du bouton valider dans la derniere colonne
// var container = $("#txt_date_of_birth");

// if (!($(e.target).is($('#txt_date_of_birth')) || $(e.target).has($('#txt_date_of_birth')).length === 0)) 
// {
//       var date = $("#txt_date_of_birth").val();
    
//      // if($('#Hid_type').val() == "")
//       {
//             if(date == null || date == "" )
//             {   //alert(date);
//                   datehid = $('#Hid_dob').val().split('-');
//                   // alert(datehid[2]);
//                   $('#txt_date_of_birth').datepicker("setDate", new Date(datehid[2],datehid[1],datehid[0]) );
                        
//             //  $('#txt_date_of_birth').val($('#Hid_dob').val());
//             }
//      } 
// }
// });

// using jQuery
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}


//$(".use-address").click(function(e) { //alert('n'); 
// $('.use-address').live('click', function (e) {
 $(document).on("click", ".use-address", function(e){
     e.preventDefault();
   //  var dobb = "02-11-2021";
    //  datehid = dobb.split('-');
                  // alert(datehid[2]);
                //  alert($(this).closest('tr').find('span').text());

     $('#Hid_type').val($(this).closest('tr').find('span').text());
     var selected = $('#ddl_employee_id').find('option:selected');
       var date_of_birth = selected.data('foo'); 
     //  var Effective_from = $('#txt_date_of_birth').val(); 
       $('#txt_date_of_birth').val(date_of_birth);
        
       datehid1 = date_of_birth.split("-"); //alert(datehid1);
       $('#txt_date_of_birth').datepicker("setDate", new Date(datehid1[2],datehid1[1],datehid1[0]) );

      //  if(Effective_from == "")
      //  { 
      //    $('#Hid_dob').val(date_of_birth);
      // }
      
            // if(Effective_from != "")
            // {
            //       dateFirst = Effective_from.split('-');
            //       dateSecond = date_of_birth.split('-');
                 
            //       var dob = new Date(dateFirst[2], dateFirst[1], dateFirst[0]); //Year, Month, Date
            //       var current = new Date(dateSecond[2], dateSecond[0], dateSecond[1]);
            //       if(dob<=current)
            //       {
            //           //  alert("Effective from date is more than Date of Joining date");
            //            // return false;
            //       } 
                  
            // }
     //else
     //alert(false);
     $('#myModal').modal('show'); 
        
      var $emp_id = $('#ddl_employee_id').val();
     // alert($emp_id);
      var $leave_id = $(this).closest("tr")   // Finds the closest row <tr> 
                       .find(".nr")     // Gets a descendent with class="nr"
                       .data("leave_id");
      $('#Hid_LeaveID').val($leave_id);    
     // alert($leave_id);             
      var csrftoken = getCookie('csrftoken');                 
     //$('#myModal').modal('show');                
      $.ajax({  
            type: "POST",  
            url: "/get_custom_leave_type",  
            data: {"csrfmiddlewaretoken": csrftoken,"emp_id": $emp_id, "leave_id": $leave_id},
            success: function(data) {  console.log(JSON.stringify(data));
                //  alert(JSON.stringify(data));
                  var check = false;
                  jQuery.each(data, function(index, item) {
                       
                       //  alert(item.fields.name);
                        if(check == false)
                        {    
                              if(typeof(item.fields.effective_from_date)  !== "undefined") 
                              {
                                    datehid = item.fields.effective_from_date.split("-").reverse(); //alert(datehid);
                                     res = 00;
                                     if(datehid[1] == 01 )
                                     res = 00;
                                     if(datehid[1] == 02 )
                                     res = 01;
                                     if(datehid[1] == 03 )
                                     res = 02;
                                     if(datehid[1] == 04 )
                                     res = 03;
                                     if(datehid[1] == 05 )
                                     res = 04;
                                     if(datehid[1] == 06 )
                                     res = 05;
                                     if(datehid[1] == 07 )
                                     res = 06;
                                     if(datehid[1] == 08 )
                                     res = 07;
                                     if(datehid[1] == 09 )
                                     res = 08;
                                     if(datehid[1] == 10 )
                                     res = 09;
                                     if(datehid[1] == 11 )
                                     res = 10;
                                     if(datehid[1] == 12 )
                                     res = 11;


                                    $('#txt_date_of_birth').datepicker("setDate", new Date(datehid[2],res,datehid[0]) );
                                  //  $('#txt_date_of_birth').val(date);
                              }
                        ///      alert(item.fields.effective_from_date);
                              //alert(item.fields.leave_type);
                              check = true;
                            
                              // $('#employee_id_other').val(item.fields.leave_type);
                              // $('#first_name_other').val(item.fields.effective_after);
                              // $('#email_id_other').val(item.fields.effective_period);
                              // $('#nick_name_other').val(item.fields.effective_from);

                              $('#customCheck1').val(item.fields.accrual);

             $("#ddl_accural_1st option:selected").each(function () {
               $(this).removeAttr('selected'); 
               });


            $("#ddl_accural_1st option[value='"+ item.fields.accrual_period +"']").attr("selected","selected").trigger('change');;

                            //  $('#ddl_accural_1st').val(item.fields.accrual_period);
                              $('#ddl_accural_2nd').val(item.fields.effective_on);
                              $('#ddl_accural_3rd').val(item.fields.effective_month);
                              $('#effect_number').val(item.fields.effective_no_of_days);

                            //  $('#title_other').val(item.fields.effective_in);

                              $('#customCheck11').val(item.fields.reset);
  $("#reset_ddl_1st option[value='"+ item.fields.reset_period +"']").attr("selected","selected").trigger('change');;
            
                           // $('#reset_ddl_1st').val(item.fields.reset_period);
                              $('#reset_ddl_2nd').val(item.fields.reset_on);
                              $('#reset_ddl_3rd').val(item.fields.reset_month);

                            //  $('#reset_ddl_carry_1st').val(item.fields.reset_carry_forward);
  $("#reset_ddl_carry_1st option[value='"+ item.fields.reset_carry_forward +"']").attr("selected","selected").trigger('change');;
                  
                              $('#carry_effect_number').val(item.fields.reset_carry_count);
                              
  $("#reset_ddl_carry_units_1st option[value='"+ item.fields.reset_carry_method +"']").attr("selected","selected").trigger('change');;
                         
                            //  $('#reset_ddl_carry_units_1st').val(item.fields.reset_carry_method);
                              $('#carry_maxlimit_effect_number').val(item.fields.reset_carry_forward_max);
                            //  $('#myModal').modal('show');          
                        }
                   //now you can access properties using dot notation
                 });
                 // alert(data);
                 // $('#query-focus').html(data);
            }
            });  

});

$(document).on("click", "#BtnSubmit", function(e){
        e.preventDefault();

      $('#txt_date_of_birth').css("border", "1px solid black");
     // alert($('#txt_date_of_birth').val());
        if($('#txt_date_of_birth').val() == "" || $('#txt_date_of_birth').val() == null)
        {
              
            $('#txt_date_of_birth').css("border", "1px solid red");
              return false;

        }
        var selected = $('#ddl_employee_id').find('option:selected');
        var date_of_birth = $('#Hid_dob').val(); 
       var Effective_from = $('#txt_date_of_birth').val(); 
      //  if(Effective_from != "")
      //  { 
      //     $('#txt_date_of_birth').val(date_of_birth);
      //     $('#Hid_dob').val(date_of_birth);
      // }
          var $status = "no_change";
            if(Effective_from != "")
            {
                  dateFirst = Effective_from.split('-');
                  dateSecond = date_of_birth.split('-');
                 
                  var dob = new Date(dateFirst[2], dateFirst[1], dateFirst[0]); //Year, Month, Date
                  var current = new Date(dateSecond[2], dateSecond[0], dateSecond[1]);
                  if(current <= dob)
                  {    $status = "changed";
                       // alert($status);
                       // return false;
                  } 
                  
            }
            str = "";
            if($('#Hid_type').val() != "")
            str = $('#Hid_type').val().replaceAll(/\s/g,'');
             
            if(str != "")
            $status = "changed";

            var selected = $('#ddl_employee_id').find('option:selected');
       var date_of_birth = selected.data('foo'); 
       var Effective_from = $('#txt_date_of_birth').val(); 

      //  if(Effective_from != "")
      //  { 
      //     $('#txt_date_of_birth').val(date_of_birth);
      //     $('#Hid_dob').val(date_of_birth);
      // }
      
            if(Effective_from != "")
            {
                  dateFirst = Effective_from.split('-');
                  dateSecond = date_of_birth.split('-');
                 
                  var dob = new Date(dateFirst[2], dateFirst[1], dateFirst[0]); //Year, Month, Date
                  var current = new Date(dateSecond[2], dateSecond[1], dateSecond[0]);
                  if(current >= dob)
                  {   //alert(dob); alert(current);
                        alert("Effective from date is should not less than Date of Joining date");
                        return false;
                  } 
                  
            }

        var $csrftoken = getCookie('csrftoken'); 
        var dateFirst = $('#txt_date_of_birth').val().split('-');
        var $effective_from_date = dateFirst[2] + "-" + dateFirst[1] + "-" + dateFirst[0] ;  
       // alert($effective_from_date);
      // accural
        var $accrual = $('#customCheck1').val();
        var $accrual_period = $('#ddl_accural_1st').val();
        var $effective_on = $('#ddl_accural_2nd').val();
        var $effective_month = $('#ddl_accural_3rd').val();
        var $effective_no_of_days = $('#effect_number').val();

      // reset
        var $reset = $('#customCheck11').val();
        var $reset_period = $('#reset_ddl_1st').val();
        var $reset_on = $('#reset_ddl_2nd').val();
        var $reset_month = $('#reset_ddl_3rd').val();
      
        var $reset_carry_forward = $('#reset_ddl_carry_1st').val();
        var $reset_carry_count = $('#carry_effect_number').val(); 
        var $reset_carry_method = $('#reset_ddl_carry_units_1st').val(); 
        var $reset_carry_forward_max = $('#carry_maxlimit_effect_number').val();                
       
        var $leave_id = $('#Hid_LeaveID').val();
        var $employee_id = $('#ddl_employee_id').val();
       // alert($employee_id);
     //$('#myModal').modal('show');                
      $.ajax({  
            type: "POST",  
            url: "/add_custom_leave_type",  
            data: {"csrfmiddlewaretoken": csrftoken,"employee_id": $employee_id, "accrual": $accrual,  
            "accrual_period": $accrual_period,  "effective_on": $effective_on,  "effective_month": $effective_month,
            "effective_no_of_days": $effective_no_of_days,  "reset": $reset,  "reset_period": $reset_period,
            "reset_on": $reset_on,  "reset_month": $reset_month,  "reset_carry_forward": $reset_carry_forward,
            "reset_carry_count": $reset_carry_count,   
            "reset_carry_method": $reset_carry_method,  "reset_carry_forward_max": $reset_carry_forward_max, 
            "effective_from_date": $effective_from_date, "leave_id": $leave_id, "status": $status,  },
           
            success: function(data) {  console.log(JSON.stringify(data));
               //   alert(JSON.stringify(data));
                  $("#tbodyid").empty();
                  $('#myModal').modal('hide');  
                  var html = "";
                  var i = 1;
                  jQuery.each(data, function(index, item) {
                       
                        // alert(item.leave_type_id);
                        var typ = "";
                       
                      //  leave_id = "{{ " +   item.leave_type_id + " }}";
                      //  alert(leave_id);
                       html += "<tr>";
                        html += "<td class = 'nr'  data-leave_id = '"+ item.leave_type_id + "'>" + i + "</td>";
                        html += "<td>" + item.name;
                  if(item.customtype != null)
                         html += '<span style="color:blue;">' +  " ( " + item.customtype + " )" + '</span>' ;  
                         html +=  "</td>";
                         html += "<td>" + item.type + "</td>";
                         html += "<td>" + item.unit + "</td>";
                        html += "<td>" + item.balance + "</td>";

                      //  html += "<td>" + item.customtype + "</td>";
                        html += "<td>" +  '<a href="javascript:void(0);" class="use-address  fas fa-add"   data-toggle="tooltip" data-original-title="Change Policy" > Customize </a>' + "</td>"; 
                       
                        html += "</tr>";
                        i++;   
                              // $('#employee_id_other').val(item.fields.leave_type);
                              // $('#first_name_other').val(item.fields.effective_after);
                              // $('#email_id_other').val(item.fields.effective_period);
                              // $('#nick_name_other').val(item.fields.effective_from);

                            //  $('#customCheck1').val(item.fields.accrual);

               });
              
               $('#datatable').append(html);
              

                  swal(
                  'Customize policy submitted successfully !',
                  '',
                  'success'
                  )


            }
              
      });
});

$('#ddl_employee_id').on('change', function() { 
   var $emp_id = ( $(this).find(":selected").val() );
  // alert($emp_id);
   var $csrftoken = getCookie('csrftoken'); 
   $.ajax({  
            type: "POST",  
            url: "/get_custom_leave_type_bychange",  
            data: {"csrfmiddlewaretoken": csrftoken,"employee_id": $emp_id  },
           
            success: function(data) { // alert(JSON.stringify(data));
                //  alert(JSON.stringify(data));
                  $("#tbodyid").empty();
                  $('#myModal').modal('hide');  
                  var html = "";
                  var i = 1;
                  var tot = 0;
                  jQuery.each(data, function(index, item) {
                       
                        // alert(item.leave_type_id);
                        var typ = "";
                       
                      //  leave_id = "{{ " +   item.leave_type_id + " }}";
                      //  alert(leave_id);
                       html += "<tr>";
                        html += "<td class = 'nr'  data-leave_id = '"+ item.leave_type_id + "'>" + i + "</td>";
                        html += "<td style='font-weight: bolder;'>" + item.name;
                 // if(item.customtype != null)
                        // html += '<span style="color:blue;">' +  " ( " + item.customtype + " )" + '</span>' ;  
                         html +=  "</td>";
                         html += "<td>" + item.type + "</td>";
                         html += "<td>" + item.unit + "</td>";
                        html += "<td>" + item.balance + "</td>";

                      //  html += "<td>" + item.customtype + "</td>";
                     //   html += "<td>" +  '<a href="javascript:void(0);" class="use-address  fas fa-add"   data-toggle="tooltip" data-original-title="Change Policy" title="Change Policy" > Customize </a>' + "</td>"; 
                       
                        html += "</tr>";
                        i++;  
                        
                        tot = parseFloat(tot) + parseFloat(item.balance);
                        // alert(tot);
               });
               if (data.length === 0) 
               html += "<tr><td colspan='4'> <center>No Records Found ! </center></td></tr>";

               html += "<tr><td></td>><td></td><td></td><td style='float: right;font-weight: bolder;'>Total Days :</td><td style='color:red;font-weight: bolder;'>"+ tot +"</td></tr>";
                //  alert('v');

               $('#datatable').append(html);
          
            }
              
      });

});


        $(document).on('click', '.confirm-delete', function(){
            return confirm('Are you sure you want to delete this role?');
        })


        // $(document).ready(function() {
        //     $('#datatable').DataTable( {
        //         dom: 'Bfrtip',
        //         buttons: [
        //             'copy', 'csv', 'excel', 'pdf', 'print'
        //         ],
        //         language: {
        //         paginate: {
        //             previous: "<i class='fas fa-angle-left'>",
        //             next: "<i class='fas fa-angle-right'>"
        //         }
        //     }
        //     } );
        // } );


        $(document).on("change", ".chkinput", function () {
   // alert();
         var id = ($(this).attr('id'));
         var arr = id.split('_');
            var inputid = "#myinputid_" + arr[1];
            $(inputid).attr('disabled','disabled');
       // alert(inputid);
        if($(this).is(":checked")) {

           $(inputid).removeAttr('disabled');
          
        }
         
    });

    $(document).on("change", ".past_chkbox", function () {
  
           $('#past_div').hide();
        if($(this).is(":checked"))
           $('#past_div').show();
      });

      $(document).on("change", ".future_chkbox", function () {
                                    
          $('.future_div').hide();
       if($(this).is(":checked"))
          $('.future_div').show();
      });

     
      $( document ).ready(function() {
            
      
          $('.maxibal').hide();
          $('.openbal').hide();
          $('#accur_in').show();
        $('#accur_ddl_4th').show();

         // $('#reset_ddl_carry_3rd_td').show();
         // $('#reset_ddl_carry_4th_td').show();
          $('#accur_ddl_2nd_td').show();

      $('.chkinput').each(function(i) {
            $(this).attr('id', 'mychkid_' + i);
            $('#reset_ddl_carry_1st_td').hide();
            $('#reset_ddl_carry_2nd_td').hide();
            });

            $('.chkinput1').each(function(i) {
            $(this).attr('id', 'myinputid_' + i);
            $(this).attr('disabled','disabled');
            });
            $('#past_div').hide();
            $('.future_div').hide();
              
            $('#reset_ddl_carry_5th_td').hide();
            $('#reset_ddl_carry_6th_td').hide();
            $('#reset_ddl_carry_7th_td').hide();
            
      });

      $('#ddl_accural_1st').on('change', function() {
        // $('#ddl_accural_2nd').find('option:selected').remove();
        var val = this.value;
        $('#ddl_accural_2nd').removeAttr('selected');
        $('#ddl_accural_3rd').removeAttr('selected');
        $('#accur_ddl_2nd_td').show();
        $('#accural_3rd_td').show();
        $('#accur_in').show();
        $('#accur_ddl_4th').show();

        $("#ddl_accural_3rd").find('option').each(function() {
         $(this).remove();
      });

      $("#ddl_accural_3rd option:selected").each(function () {
               $(this).removeAttr('selected'); 
               });

               $("#ddl_accural_2nd option:selected").each(function () {
               $(this).removeAttr('selected'); 
              // alert( $(this).val());
                  if($(this).val() == 1 && val == "00")
                  {
                        $(this).remove();
                        $('#ddl_accural_2nd').append($('<option>', { 
                              value: '1',
                              text : '1st' 
                        }));
                        $('#ddl_accural_2nd').append( $("#ddl_accural_2nd option[value='-1']").attr("selected","selected"));
                  }
                  else
                  {
                        //$(this).remove();
                        $('#ddl_accural_2nd option[value="1"]').remove();
                        $('#ddl_accural_2nd').append($('<option>', { 
                              value: '1',
                              text : '1st' 
                        }));

                        $('#ddl_accural_2nd').append( $("#ddl_accural_2nd option[value='1']").attr("selected","selected"));
                  }
               });
       
         // alert( this.value );
         var $id = "#ddl_accural_3rd";
       
       if(val == "00")  // one time
       {  
            bind_yearly($id);
            
              
           $('#ddl_accural_2nd').removeAttr('selected');
        $("#ddl_accural_2nd option[value='-1']").attr("selected","selected");
        $("#ddl_accural_3rd option[value='-1']").attr("selected","selected");
        $('#accur_in').hide();
        $('#accur_ddl_4th').hide();
       }
      // $('').show();
    else if(val == "01")  //year
       {  // alert('y');
             bind_yearly($id);
             $('#ddl_accural_3rd').removeAttr('selected');
            $("#ddl_accural_2nd option[value='1']").attr("selected","selected");
            $("#ddl_accural_3rd option[value='1']").attr("selected","selected");
            $('#accur_in').show();
            $('#accur_ddl_4th').show();
       }
    else if(val == "11") //month
    {
      bind_yearly($id);
        $("#ddl_accural_2nd option[value='1']").attr("selected","selected");
       // $("#ddl_accural_3rd option[value='-1']").attr("selected","selected");
        $('#accural_3rd_td').hide();
        $('#accur_ddl_4th').show();
    }
    else if(val == "16") //half
     {
           
        $("#ddl_accural_2nd option[value='1']").attr("selected","selected");
       // $("#ddl_accural_3rd option[value='-1']").attr("selected","selected");
        $('#accural_3rd_td').show();
        $('#accur_ddl_4th').show();
        
        
      bind_monthly($id); 

     }
    else if(val == "14") //trianually
       {
            bind_triannually($id);
       }
    else if(val == "13") //quaterly
       {
            bind_quarterly($id);
       } 
    else if(val == "12") //bimonthly
       {
            bind_bimonthly($id);
       }
    else if(val == "315") //semi monthly
       {
            bind_semi_monthly($id);
            $('#accur_ddl_2nd_td').hide();
       }
    else if(val == "22") // bi weekly
       {
            bind_bi_weekly($id);
            $('#accur_ddl_2nd_td').hide();
       }
    else if(val == "21") //  weekly
       {
            bind_bi_weekly($id);
            $('#accur_ddl_2nd_td').hide();
       }
});

$('#reset_ddl_1st').on('change', function() {  //alert();
        // $('#ddl_accural_2nd').find('option:selected').remove();
        $('#reset_ddl_2nd').removeAttr('selected');
        $('#reset_ddl_3rd').removeAttr('selected');
        $("#reset_ddl_2nd").removeProp("selected");
        $("#reset_ddl_3rd").removeProp("selected");

        $("#reset_ddl_2nd option:selected").each(function () {
               $(this).removeAttr('selected'); 
               });
        
       // $('#accur_ddl_2nd_td').show();
       $('#reset_ddl_2nd_td').show();
       $('#reset_ddl_1st_td').show();

        $("#reset_ddl_3rd").find('option').each(function() {
         $(this).remove();
      });
       
         // alert( this.value );
         var $id = "#reset_ddl_3rd";
       var val = this.value;
       if(val == "00")  // one time
       {
           bind_yearly($id);
           $('#reset_ddl_2nd').removeAttr('selected');
        $("#reset_ddl_2nd option[value='-1']").attr("selected","selected");
        $("#reset_ddl_3rd option[value='-1']").attr("selected","selected");
       // $('#accur_in').hide();
       // $('#accur_ddl_4th').hide();
       }
      // $('').show();
    else if(val == "01")  //year
       {  // alert('y');
             bind_yearly($id);
             $('#reset_ddl_3rd').removeAttr('selected');
             $('#reset_ddl_2nd').removeAttr('selected');
            $("#ddl_accural_2nd option[value='32']").attr("selected","selected");
         //   $("#reset_ddl_3rd option[value='1']").attr("selected","selected");
           // $('#accur_in').show();
           // $('#accur_ddl_4th').show();
       }
    else if(val == "11") //month
    {
      bind_yearly($id);
      $('#reset_ddl_2nd').removeAttr('selected');
        $("#reset_ddl_2nd option[value='32']").attr("selected","selected");
       // $("#ddl_accural_3rd option[value='-1']").attr("selected","selected");
        $('#reset_ddl_2nd_td').hide();
       // $('#accur_ddl_4th').show();
    }
    else if(val == "16") //half
     {
      $('#reset_ddl_2nd').removeAttr('selected');
      $("#reset_ddl_2nd option[value='32']").attr("selected","selected");
       // $("#ddl_accural_3rd option[value='-1']").attr("selected","selected");
      //  $('#accural_3rd_td').show();
      //  $('#accur_ddl_4th').show();
       
        bind_monthly($id); 

     }
    else if(val == "14") //trianually
       {
            bind_triannually($id);
       }
    else if(val == "13") //quaterly
       {
            bind_quarterly($id);
       } 
    else if(val == "12") //bimonthly
       {
            bind_bimonthly($id);
       }
    else if(val == "315") //semi monthly
       {
            bind_semi_monthly($id);
            $('#reset_ddl_1st_td').hide();
            $('#reset_ddl_2nd').removeAttr('selected');
            $("#reset_ddl_2nd option[value='15']").attr("selected","selected");
       }
    else if(val == "22") // bi weekly
       {
            bind_bi_weekly($id);
            $('#reset_ddl_1st_td').hide();
            $('#reset_ddl_2nd').removeAttr('selected');
            $("#reset_ddl_2nd option[value='6']").attr("selected","selected");
       }
    else if(val == "21") //  weekly
       {
            bind_bi_weekly($id);
            $('#reset_ddl_1st_td').hide();
            $('#reset_ddl_2nd').removeAttr('selected');
            $("#reset_ddl_2nd option[value='6']").attr("selected","selected");
       }
});

$('#reset_ddl_carry_1st').on('change', function() {  //alert();
       
      $('#reset_ddl_carry_1st_td').show();
      $('#reset_ddl_carry_2nd_td').show();
      $('#reset_ddl_carry_3rd_td').hide();
      $('#reset_ddl_carry_4th_td').hide();

      $('#reset_ddl_carry_5th_td').hide();
            $('#reset_ddl_carry_6th_td').hide();
            $('#reset_ddl_carry_7th_td').hide();

      var $id = "#reset_ddl_3rd";
       var val = this.value;
       if(val == "0")  // one time
       {
            $('#reset_ddl_carry_1st_td').hide();
      $('#reset_ddl_carry_2nd_td').hide();
            $('#reset_ddl_carry_3rd_td').show();
             $('#reset_ddl_carry_4th_td').show();
       
       } 

       if(val == "1")  // one time 
       {
            $('#reset_ddl_carry_1st_td').hide();
            $('#reset_ddl_carry_2nd_td').hide();
            $('#reset_ddl_carry_3rd_td').show();
            $('#reset_ddl_carry_4th_td').show();

            $('#reset_ddl_carry_5th_td').show();
            $('#reset_ddl_carry_6th_td').show();
            $('#reset_ddl_carry_7th_td').show();

            
       } 

       if(val == "2")  // one time 
       {
            $('#reset_ddl_carry_1st_td').show();
            $('#reset_ddl_carry_2nd_td').show();
            $('#reset_ddl_carry_3rd_td').show();
            $('#reset_ddl_carry_4th_td').show();

            $('#reset_ddl_carry_5th_td').hide();
            $('#reset_ddl_carry_6th_td').hide();
            $('#reset_ddl_carry_7th_td').hide();

            
       } 
      // $('').show(); reset_ddl_carry_1st
   }); 

   $('#reset_ddl_carry_units_1st').on('change', function() {  //alert();
       
       $('#reset_ddl_carry_1st_td').show();
       $('#reset_ddl_carry_2nd_td').show();
       $('#reset_ddl_carry_3rd_td').hide();
       $('#reset_ddl_carry_4th_td').hide();
        //  alert(this.value)
       var $id = "#reset_ddl_3rd";
        var val = this.value;
        if(val == "1")  // one time
        {
             $('#reset_ddl_carry_3rd_td').show();
             $('#reset_ddl_carry_4th_td').show();
            $('#reset_ddl_carry_2nd_td').show();
            $('#reset_ddl_carry_1st_td').show();
            
        }
        if(val == "0")  // one time
        {
            
            $('#reset_ddl_carry_2nd_td').hide();
            $('#reset_ddl_carry_1st_td').hide();

            var carry = $('#reset_ddl_carry_1st').val();
            if(carry == 2)
            {
                  
                  $('#reset_ddl_carry_1st_td').show();
                  $('#reset_ddl_carry_2nd_td').show();
            }
        }
       // $('').show();
    });

    $('#reset_ddl_carry_last').on('change', function() {  //alert();
       
       $('#reset_ddl_carry_last0_td').hide();
       $('#reset_ddl_carry_last1_td').hide();
      
       var $id = "#reset_ddl_3rd";
        var val = this.value;
        if(val == "1")  // one time
        {
             $('#reset_ddl_carry_last0_td').show();
              $('#reset_ddl_carry_last1_td').show();
        // $('#accur_in').hide();
        // $('#accur_ddl_4th').hide();
        }
       // $('').show();
    });

 function bind_yearly(id)
{
    var select = $(id);
        var newOptions = {
                    'Jan' : '1',
                    'Feb' : '2',
                    'Mar' : '3',
                    'Apr' : '4',
                    'May' : '5',
                    'Jun' : '6',
                    'Jul' : '7',
                    'Aug' : '8',
                    'Sep' : '9',
                    'Oct' : '10',
                    'Nov' : '11',
                    'Dec' : '12',
                    'Policy Month' : '-1',
                    'Joining Month' : '-2',
                    'Birth Month' : '-3'
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });

}

function bind_one_time(id)
{
    var select = $(id);
        var newOptions = {
                    '1st' : '1',
                    '2nd' : '2',
                    '3rd' : '3',
                    '4th' : '4',
                    '5th' : '5',
                    '6th' : '6',
                    '7th' : '7',
                    '8th' : '8',
                    '9th' : '9',
                    '10th' : '10',
                    '11th' : '11',
                    '12th' : '12',
                    '13th' : '13',
                    '14th' : '14',
                    '15th' : '15',
                    '16th' : '16',
                    '17th' : '17',
                    '18th' : '18',
                    '19th' : '19',
                    '20th' : '20',
                    '21th' : '21',
                    '22th' : '22',
                    '23th' : '23',
                    '24th' : '24',
                    '25th' : '25',
                    '26th' : '26',
                    '27th' : '27',
                    '28th' : '28',
                    '29th' : '29',
                    '30th' : '30',
                    '31st' : '31',
                    'Last Day' : '32',
                    'Policy Date' : '-1',
                    'Joining Date' : '-2',
                    'Birth Date' : '-3'
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });

}

function bind_monthly(id)
{
      var select = $(id);
        var newOptions = {
                    'Jan & Jul' : '1',
                    'Feb & Aug' : '2',
                    'Mar & Sep' : '3',
                    'Apr & Oct' : '4',
                    'May & Nov' : '5',
                    'Jun & Dec' : '6',
                    'Policy Month' : '-1',
                    'Joining Month' : '-2',
                    'Birth Month' : '-3'
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }

    function bind_triannually(id)
    {
      var select = $(id);
        var newOptions = {
                    'Jan & May & Sep' : '1',
                    'Feb & Jun & Oct' : '2',
                    'Mar & Jul & Nov' : '3',
                    'Apr & Aug & Dec' : '4',
                    'Policy Month' : '-1',
                    'Joining Month' : '-2',
                    'Birth Month' : '-3',
                    
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }
    function bind_quarterly(id)
    {
      var select = $(id);
        var newOptions = {
                    'Jan & Apr & Jul & Oct' : '1',
                    'Feb & May & Aug & Nov' : '2',
                    'Mar & Jun & Sep & Dec' : '3',
                     'Policy Month' : '-1',
                    'Joining Month' : '-2',
                    'Birth Month' : '-3',
                    
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }

    function bind_bimonthly(id)
    {
      var select = $(id);
        var newOptions = {
                    'Jan & Mar & May & Jul & Sep & Nov' : '1',
                    'Feb & Apr & Jun & Aug & Oct & Dec' : '2',
                    'Policy Month' : '-1',
                    'Joining Month' : '-2',
                    'Birth Month' : '-3',
                    
                    
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }

    function bind_semi_monthly(id)
    {
      var select = $(id);
        var newOptions = {
                    '1 & 16' : '1',
                    '2 & 17' : '2',
                    '3 & 18' : '3',
                    '4 & 19' : '4',
                    '5 & 20' : '5',
                    '6 & 21' : '6',
                    '7 & 22' : '7',
                    '8 & 23' : '8',
                    '9 & 24' : '9',
                    '10 & 25' : '10',
                    '11 & 26' : '11',
                    '12 & 27' : '12',
                    '13 & 28' : '13',
                    '14 & 29' : '14',
                    '15 & 30' : '15'
                   
                };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }

    function bind_bi_weekly(id)
    {
      var select = $(id);
        var newOptions = {
                    'Sun' : '0',
                    'Mon' : '1',
                    'Tue' : '2',
                    'Wed' : '3',
                    'Thu' : '4',
                    'Fri' : '5',
                    'Sat' : '6',
                   };
        $('option', select).remove();
        $.each(newOptions, function(text, key) {
        var option = new Option(text, key);
        select.append($(option));
        });
    }

function valueChanged_accur(evt)
    {// alert($('.accurcheck').is(":checked"));
    evt.preventDefault();
        if($('.accurcheck').is(":checked"))   
            $(".accur").show();
        else
            $(".accur").hide();
            return false;
    }
function valueChanged_reset(evt)
    {// alert($('.accurcheck').is(":checked"));
    evt.preventDefault();  alert('v');
        if($('.resetcheck').is(":checked"))   
            $(".reset").show();
        else
            $(".reset").hide();
            return false;
    }
 function valueChanged_openbal(evt)
    {// alert($('.accurcheck').is(":checked"));
    evt.preventDefault(); //alert('v');
        if($('.openbalcheck').is(":checked"))   
            $(".openbal").show();
        else
            $(".openbal").hide();
            return false;
    }
    function valueChanged_maxibal(evt)
    {// alert($('.accurcheck').is(":checked"));
    evt.preventDefault(); //alert('v');
        if($('.maxibalcheck').is(":checked"))   
            $(".maxibal").show();
        else
            $(".maxibal").hide();
            return false;
    }

   var tot = 0;
    $('#datatable tr').each(function() {
        
    var elem = $(this).find('td:last');
     
    if(elem.html() != "" && typeof(elem.html()) != "undefined" && elem.attr('id') != "last_td")
    { //alert(elem.attr('id'));
       tot = parseFloat(tot) + parseFloat(elem.html());
      // alert(tot);
       $('#last_td').html(tot);
    }
  //do something with elem
});


    </script>

{% endblock javascripts %}


